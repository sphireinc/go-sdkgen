{
  "swagger": "2.0",
  "info": {
    "title": "Job Engine API",
    "version": "1.0.0"
  },
  "basePath": "/api/v1",
  "schemes": ["https"],
  "produces": ["application/json"],
  "consumes": ["application/json"],
  "paths": {
    "/jobs/runs/{id}": {
      "get": {
        "operationId": "fetchWorkflows",
        "summary": "Fetch workflow runs for a job",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "string" }
        ],
        "responses": {
          "200": { "description": "OK", "schema": { "$ref": "#/definitions/WorkflowRunList" } }
        }
      }
    },
    "/jobs/runs/graph/{id}/{jobRunId}": {
      "get": {
        "operationId": "fetchJobDetails",
        "summary": "Fetch job run graph details",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "string" },
          { "name": "jobRunId", "in": "path", "required": true, "type": "string" },
          { "name": "includeLogs", "in": "query", "required": false, "type": "boolean" }
        ],
        "responses": {
          "200": { "description": "OK", "schema": { "$ref": "#/definitions/JobRunGraph" } }
        }
      }
    },
    "/jobs": {
      "post": {
        "operationId": "createJob",
        "summary": "Create a job",
        "parameters": [
          { "name": "body", "in": "body", "required": true, "schema": { "$ref": "#/definitions/CreateJobRequest" } }
        ],
        "responses": {
          "201": { "description": "Created", "schema": { "$ref": "#/definitions/Job" } }
        }
      }
    },
    "/jobs/run/{jobName}": {
      "post": {
        "operationId": "runJobNow",
        "summary": "Run a job immediately",
        "parameters": [
          { "name": "jobName", "in": "path", "required": true, "type": "string" }
        ],
        "responses": {
          "202": { "description": "Accepted", "schema": { "$ref": "#/definitions/RunJobResponse" } }
        }
      }
    }
  },
  "definitions": {
    "WorkflowRunList": {
      "type": "object",
      "properties": {
        "runs": {
          "type": "array",
          "items": { "$ref": "#/definitions/WorkflowRun" }
        }
      }
    },
    "WorkflowRun": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "status": { "type": "string" },
        "startedAt": { "type": "string" }
      }
    },
    "JobRunGraph": {
      "type": "object",
      "properties": {
        "nodes": { "type": "array", "items": { "type": "object" } },
        "edges": { "type": "array", "items": { "type": "object" } }
      }
    },
    "CreateJobRequest": {
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": { "type": "string" },
        "schedule": { "type": "string" }
      }
    },
    "Job": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "createdAt": { "type": "string" }
      }
    },
    "RunJobResponse": {
      "type": "object",
      "properties": {
        "runId": { "type": "string" },
        "accepted": { "type": "boolean" }
      }
    }
  }
}